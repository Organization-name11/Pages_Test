(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(8612)}])},984:function(t){"use strict";let e="Pages_Test";t.exports={output:"export",basePath:"/".concat(e),assetPrefix:"/".concat(e,"/"),images:{unoptimized:!0}}},8612:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return b}});var n=r(5893),o=r(7294);let i={f:0,x:0,y:0,z:0},l=180/Math.PI;function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{f:r,x:n,y:o,z:i}=t;if(e<=0)throw Error("steps must be greater than 0");if(e>i)throw Error("Getting parent tile of ".concat(JSON.stringify(t),", ").concat(e," steps is not possible because it would go beyond the root tile (z=0)"));return{f:r>>e,x:n>>e,y:o>>e,z:i-e}}function s(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,{f:e,x:r,y:n,z:o}=t;return[{f:2*e,x:2*r,y:2*n,z:o+1},{f:2*e,x:2*r+1,y:2*n,z:o+1},{f:2*e,x:2*r,y:2*n+1,z:o+1},{f:2*e,x:2*r+1,y:2*n+1,z:o+1},{f:2*e+1,x:2*r,y:2*n,z:o+1},{f:2*e+1,x:2*r+1,y:2*n,z:o+1},{f:2*e+1,x:2*r,y:2*n+1,z:o+1},{f:2*e+1,x:2*r+1,y:2*n+1,z:o+1}]}function f(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,{f:e,x:r,y:n,z:o}=t;return[h({f:e,x:r,y:n,z:o}),h({f:e,x:r+1,y:n,z:o}),h({f:e,x:r,y:n+1,z:o}),h({f:e,x:r+1,y:n+1,z:o}),h({f:e,x:r-1,y:n,z:o}),h({f:e,x:r,y:n-1,z:o}),h({f:e,x:r-1,y:n-1,z:o}),h({f:e,x:r+1,y:n-1,z:o}),h({f:e,x:r-1,y:n+1,z:o})]}function u(t){let e=Math.PI-2*Math.PI*t.y/Math.pow(2,t.z);return{lng:t.x/Math.pow(2,t.z)*360-180,lat:l*Math.atan(.5*(Math.exp(e)-Math.exp(-e)))}}function h(t){let{z:e,f:r,x:n,y:o}=t;return{z:e,f:Math.max(Math.min(r,2**e),-(2**e)),x:n<0?n+2**e:n%2**e,y:o<0?o+2**e:o%2**e}}var c=r(6290),x=r(4347);let y=Math.PI/180;function d(t,e){if("number"!=typeof t||Number.isNaN(t))throw Error("Expected number for '".concat(e,"', got ").concat(String(t)));return t}function z(t){let e=d(t[0],"bbox[0] (minX)");return[e,d(t[1],"bbox[1] (minY)"),d(t[2],"bbox[2] (maxX)"),d(t[3],"bbox[3] (maxY)")]}function m(t,e,r){let n,o,i;let l=(n=Math.sin(e*y),(i=(o=Math.pow(2,r))*(t/360+.5)%o)<0&&(i+=o),[i,o*(.5-.25*Math.log((1+n)/(1-n))/Math.PI),r]);return l[0]=Math.floor(l[0]),l[1]=Math.floor(l[1]),l}function g(t,e){if("number"!=typeof t||Number.isNaN(t))throw Error("Expected number for '".concat(e,"', got ").concat(String(t)));return t}class p{up(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.move({f:t})}down(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.move({f:-t})}north(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.move({y:t})}south(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.move({y:-t})}east(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.move({x:t})}west(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.move({x:-t})}move(t){var e,r,n;let o=new p(this.zfxy),i=g(o.zfxy.z,"zfxy.z"),l=g(o.zfxy.f,"zfxy.f")+(null!==(e=t.f)&&void 0!==e?e:0),a=g(o.zfxy.x,"zfxy.x")+(null!==(r=t.x)&&void 0!==r?r:0),s=g(o.zfxy.y,"zfxy.y")+(null!==(n=t.y)&&void 0!==n?n:0);return o.zfxy=h({z:i,f:l,x:a,y:s}),o._regenerateAttributesFromZFXY(),o}parent(t){let e=void 0===t?1:g(this.zfxy.z,"zfxy.z")-g(t,"atZoom");return new p(a(this.zfxy,e))}children(){return s(this.zfxy).map(t=>new p(t))}surroundings(){return[...f(this.zfxy).filter(t=>{let{z:e,f:r,x:n,y:o}=t;return"/".concat(e,"/").concat(r,"/").concat(n,"/").concat(o)!==this.zfxyStr}).map(t=>new p(t)),...f(this.up().zfxy).map(t=>new p(t)),...f(this.down().zfxy).map(t=>new p(t))]}toPolygon(){var t;let[e,r,n,o]=function(t){if(Array.isArray(t)&&4===t.length&&t.every(t=>"number"==typeof t))return t;if(Array.isArray(t)&&2===t.length){let e=t[0],r=t[1],n="number"==typeof(null==e?void 0:e.lng)?e.lng:Array.isArray(e)?e[0]:void 0,o="number"==typeof(null==e?void 0:e.lat)?e.lat:Array.isArray(e)?e[1]:void 0,i="number"==typeof(null==r?void 0:r.lng)?r.lng:Array.isArray(r)?r[0]:void 0,l="number"==typeof(null==r?void 0:r.lat)?r.lat:Array.isArray(r)?r[1]:void 0;return[g(n,"bbox.minX"),g(o,"bbox.minY"),g(i,"bbox.maxX"),g(l,"bbox.maxY")]}throw Error("Unsupported BBox format returned by getBBox()")}([u(t=this.zfxy),u({...t,y:t.y+1,x:t.x+1})]);return{type:"Polygon",coordinates:[[[e,r],[n,r],[n,o],[e,o],[e,r]]]}}intersects(t){let e=this.toPolygon();return(0,x.Z)(e,t)}intersectingNeighbors(t){let e=function(t,e){let[r,n,o,i]=z(t),l=m(r,n,32),a=m(o,i,32),s=[l[0],l[1],a[0],a[1]],f=Math.min(function(t){let[e,r,n,o]=z(t);for(let t=0;t<28;t++){let i=1<<32-(t+1);if((e&i)!=(n&i)||(r&i)!=(o&i))return t}return 28}(s),28);return 0===f?[0,0,0]:[s[0]>>>32-f,s[1]>>>32-f,f]}((0,c.Z)(t)),r=g(e[0],"repTile.x"),n=g(e[1],"repTile.y"),o=g(this.zfxy.z,"zfxy.z");return new p({z:"number"==typeof e[2]?e[2]:o,f:g(this.zfxy.f,"zfxy.f"),x:r,y:n}).surroundings().filter(e=>e.intersects(t))}static fromCenter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;return new p(t,g(e,"zoom"))}static fromPoint(t,e,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:25,o=g(t,"lng"),i=g(e,"lat"),l=g(n,"z"),a=g(r,"f"),s=m(o,i,l);return new p({z:l,f:a,x:g(s[0],"tile.x"),y:g(s[1],"tile.y")})}_regenerateAttributesFromZFXY(){var t,e;if(!this.zfxy)throw Error("zfxy is not set");let r=g(this.zfxy.z,"zfxy.z"),n=g(this.zfxy.f,"zfxy.f"),o=g(this.zfxy.x,"zfxy.x"),i=g(this.zfxy.y,"zfxy.y");this.zoom=r,this.zfxyStr="/".concat(r,"/").concat(n,"/").concat(o,"/").concat(i),this.tilehash=function(t){let{f:e,x:r,y:n,z:o}=t,i=e,l="";for(;o>0;){let t={f:Math.abs(e),x:r,y:n,z:o},i=a(t),f=s(i).findIndex(t=>t.f===Math.abs(e)&&t.x===r&&t.y===n&&t.z===o);if(f<0)throw Error("Could not determine position in parent for tile ".concat(JSON.stringify(t)));l=(f+1).toString()+l,e=i.f,r=i.x,n=i.y,o=i.z}return(i<0?"-":"")+l}({z:r,f:n,x:o,y:i}),this.id=this.tilehash;let l={...u({x:2*(e=t={z:r,f:n,x:o,y:i}).x+1,y:2*e.y+1,z:e.z+1,f:0}),alt:33554432*t.f/2**t.z+33554432/2**(t.z+1)};this.center=l,this.alt=g(l.alt,"center.alt")}constructor(t,e){if("string"==typeof t){let e=function(t){var e,r,n,o;let i=t.match(/^\/?(\d+)\/(?:(\d+)\/)?(\d+)\/(\d+)$/);if(!i)return;let l=null!==(e=i[1])&&void 0!==e?e:"",a=null!==(r=i[2])&&void 0!==r?r:"0",s=null!==(n=i[3])&&void 0!==n?n:"",f=null!==(o=i[4])&&void 0!==o?o:"";if(""===l||""===s||""===f)return;let u=parseInt(l,10),h=parseInt(a,10),c=parseInt(s,10),x=parseInt(f,10);if(![u,h,c,x].some(t=>Number.isNaN(t)))return{z:u,f:h,x:c,y:x}}(t)||function(t){let e,r=!1;"-"===t[0]&&(r=!0,t=t.substring(1));let n=s();for(let o of t){let i=parseInt(o,10)-1;if(!Number.isFinite(i)||i<0||i>=n.length)throw Error("Invalid tilehash character '".concat(o,"' in '").concat(r?"-":"").concat(t,"'"));let l=n.at(i);if(!l)throw Error("Invalid tilehash character '".concat(o,"' in '").concat(r?"-":"").concat(t,"'"));n=s(e=l)}if(!e)throw Error("Invalid tilehash '".concat(r?"-":"").concat(t,"'"));return r?{...e,f:-e.f}:e}(t);if(e)this.zfxy=e,this._regenerateAttributesFromZFXY();else throw Error("parse ZFXY failed with input: ".concat(t));return}if("z"in t&&"f"in t&&"x"in t&&"y"in t){this.zfxy=t,this._regenerateAttributesFromZFXY();return}this.zfxy=function(t){let e=void 0!==t.alt?t.alt:0;if(e<=-33554432||e>=33554432)throw Error("ZFXY only supports altitude between -2^".concat(25," and +2^").concat(25,"."));let r=Math.floor(2**t.zoom*e/33554432),n=Math.sin(t.lat*(Math.PI/180)),o=2**t.zoom,i=o*(t.lng/360+.5);return(i%=o)<0&&(i+=o),{f:r,x:Math.floor(i),y:Math.floor(o*(.5-.25*Math.log((1+n)/(1-n))/Math.PI)),z:t.zoom}}({...t,zoom:void 0!==e?e:25}),this._regenerateAttributesFromZFXY()}}let v=r(984).basePath||"";function b(){let[t,e]=(0,o.useState)(""),[r,i]=(0,o.useState)(""),[l,a]=(0,o.useState)("25"),[s,f]=(0,o.useState)(""),[u,h]=(0,o.useState)(null),[c,x]=(0,o.useState)("");return(0,n.jsxs)("div",{style:{padding:"20px",fontFamily:"sans-serif"},children:[(0,n.jsx)("h1",{children:"Spatial ID 計算ツール（クライアント計算）"}),(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),console.log("[onSubmit] clicked:",{lat:t,lon:r,zoom:l,alt:s}),x(""),h(null);try{if(!t||!r){x("lat と lon は必須です");return}let e=parseFloat(t),n=parseFloat(r),o=parseInt(l||"25",10),i=""!==s?parseFloat(s):void 0;if(!Number.isFinite(e)||!Number.isFinite(n)){x("lat と lon は数値である必要があります");return}if(!Number.isFinite(o)){x("zoom は数値である必要があります");return}if(""!==s&&!Number.isFinite(i)){x("alt が指定されている場合は数値である必要があります");return}if(e<-85.0511287798||e>85.0511287798){x("lat の範囲は \xb185.0511287798");return}if(n<-180||n>180){x("lon の範囲は \xb1180");return}if(o<0||o>35){x("zoom は 0〜35");return}let a=new p(void 0===i?{lng:n,lat:e}:{lng:n,lat:e,alt:i},o);h({zfxyStr:a.zfxyStr,tilehash:a.tilehash,zfxy:a.zfxy,zoom:a.zoom,center:a.center,alt:a.alt})}catch(t){console.error("[client calc] error:",t),x("計算エラー: "+((null==t?void 0:t.message)||String(t)))}},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"緯度(lat): "}),(0,n.jsx)("input",{value:t,onChange:t=>e(t.target.value),required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"経度(lon): "}),(0,n.jsx)("input",{value:r,onChange:t=>i(t.target.value),required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"ズーム(zoom): "}),(0,n.jsx)("input",{value:l,onChange:t=>a(t.target.value)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"高度(alt): "}),(0,n.jsx)("input",{value:s,onChange:t=>f(t.target.value)})]}),(0,n.jsx)("button",{type:"submit",children:"計算"})]}),c&&(0,n.jsx)("p",{style:{color:"red"},children:c}),u&&(0,n.jsxs)("div",{style:{marginTop:16,padding:12,border:"1px solid #ddd",borderRadius:8,background:"#fafafa",maxWidth:560,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:[(0,n.jsx)("h2",{style:{margin:0,marginBottom:8},children:"結果"}),(0,n.jsx)("pre",{style:{margin:0},children:JSON.stringify(u,null,2)})]}),(0,n.jsx)("div",{style:{marginTop:16},children:(0,n.jsx)("img",{alt:"logo",src:"".concat(v,"/logo.svg"),width:120,height:36,onError:t=>{var e;t.currentTarget.style.display="none";let r=document.createElement("div");r.textContent="[logo 読み込み失敗]",r.style.color="#888",null===(e=t.currentTarget.parentElement)||void 0===e||e.appendChild(r)}})})]})}}},function(t){t.O(0,[791,888,774,179],function(){return t(t.s=5557)}),_N_E=t.O()}]);